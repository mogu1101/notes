### 工作流程
#### 打包
- 打包地址：http://build.zhenguanyu.com/view/pumpkin/job/pumpkin-flutter-app/
- Build with Parameters
  - iOS
    - PLATFORM：iOS
    - TARGET：
      - alpha：用于测push、支付等功能（Yuanli Development证书）
      - beta：用于正常测试（企业版Fenbiweilai Distribution证书）
      - appstore：TestFlight包
    - BRANCH：打包分支
    - COMMIT_ID：打包的commit id
    - TRIGGER_USER：用于在打完包通过企业微信通知，输入响应人员的ldap，多人之间已空格分割
  - Android
    - PLATFORM：android
    - TARGET：
      - alpha：用于正常测试
      - release：用于发版
    - BRANCH：打包分支
    - COMMIT_ID：打包的commit id
    - TRIGGER_USER：用于在打完包通过企业微信通知，输入响应人员的ldap，多人之间已空格分割
    - ANDROID_VENDOR：Android打包渠道名称，可以不填，默认为all，表示打所有渠道的渠道包。可以填入单个渠道，多个渠道间以英文逗号','分隔，如：huawei,xiaomi,oppo
    - REINFORCE_TYPE
      - 360API表示360私有部署加固
      - 360tool表示360公版加固
- Configure
  - 添加/删除/修改打包参数
  - Source Code Management：修改仓库地址
  - Build Triggers：设置打包触发时机
  - Build Environment：设置打包环境变量
  - Build：设置打包脚本
- 权限管理
  - https://confluence.zhenguanyu.com/pages/viewpage.action?pageId=148767229
- 打包机配置
  - 地址：10.1.60.234
  - WorkSpace：
    - iOS：~/jenkins/Flutter/iOS/sci_flutter
    - Android：~/jenkins/Flutter/android/sci_flutter
  - 每次只能打包一个iOS任务和一个Android任务
- 打包环境配置
  - iOS Fastlane 环境配置
    - 使用 bundle 管理 Fastlane 和 Cocoapods 版本
    - gem install bundler
    - 到 ios 目录下，bundle install --path ./.bundle
- 脚本 Tools
  - setupProject.sh 项目初始化（添加 git hooks）
    - 从远端拷贝 commit-msg
    - 在 pre-commit 中添加 flutter 格式化
  - update_version.sh 版本号升级
    - 升级 version number，build number + 1
    - 更新版本对应签名文件
  - git_submit.sh：git push 到对应分支，并添加reviewer
  - jenkinsBuild.sh
    - 检查环境配置
    - 调用 Fastlane 打包 iOS
    - 调用 build_apk.sh 打包 android
    - 调用 weixin_notify.sh 相应人员
  - 本地打包
    - iOS:
      - beta包：cd ios && bundle exec fastlane build build_tag:beta branch:{BRANCH_NAME}
      - testflight：cd ios && bundle exec fastlane build_testflight branch:${BRANCH_NAME}
    - Android: ./Tools/build_apk.sh "alpha" "tencent" "360API" "liujj03"
- 上传 app.zhenguanyu.com 配置
    - 测试服务权限申请工单
      - https://process.zhenguanyu.com/ticket/new/31
      - 主题：上传测试包到 app.zhenguanyu.com
      - 环境：test
      - 服务名：op-app
    - 上传 ssh public key 到 http://key.zhenguanyu.com/
#### 发版
- 开发流程：https://confluence.zhenguanyu.com/pages/viewpage.action?pageId=163636427
- 发版流程：https://confluence.zhenguanyu.com/pages/viewpage.action?pageId=140292986
#### log
- CLog
  - 阿里云SLS（日志保留一天）: 
    - 地址：https://sls.console.aliyun.com/lognext/project/tutor-clog/logsearch/solar-clog-online
    - 使用指南：https://confluence.zhenguanyu.com/pages/viewpage.action?pageId=148549244
  - ELK（日志保留七天）：https://bigdata-clog-kibana.zhenguanyu.com/app/discover#/?_g=(filters:!(),refreshInterval:(pause:!t,value:0),time:(from:now-15m,to:now))&_a=(columns:!(),filters:!(),index:db7ae3c0-1525-11ec-abda-e3823d723665,interval:auto,query:(language:kuery,query:''),sort:!(!(timestamp,desc)))
- Frog
- Sentry
  - https://confluence.zhenguanyu.com/pages/viewpage.action?pageId=186504813
#### 常用平台
- 权限管理
  - https://confluence.zhenguanyu.com/pages/viewpage.action?pageId=226489235
- Mars：灰度平台 https://mars.zhenguanyu.com/ 
- Switch：功能开关配置
  - 测试：https://switch-test.zhenguanyu.com/
  - 线上：https://switch-test.zhenguanyu.com/
  - 使用方法：https://confluence.zhenguanyu.com/pages/viewpage.action?pageId=107822499
- 实验平台：ABTest 实验控制，配合 Switch 开关使用
  - 测试：https://switch-test.zhenguanyu.com/experiment/#/
  - 线上：https://switch.zhenguanyu.com/experiment/#/
- 配置中心：管理App 配置项（我的页面、Tab图标配置等）
  - 测试：https://switch-test.zhenguanyu.com/config/#/
  - 线上：https://switch.zhenguanyu.com/config/#/
  - 使用方法：https://confluence.zhenguanyu.com/pages/viewpage.action?pageId=204221086

### 后续工作
- Flutter 3.0
- 环节组件化
- 项目重构 模块化
- 拍照/拍视频SDK接入
- 应用市场上传脚本